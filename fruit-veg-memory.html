<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸“æ³¨åŠ›å’Œè®°å¿†åŠ›è®­ç»ƒæ¸¸æˆ</title>
    <style>
        body {
    margin: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    font-family: Arial, sans-serif;
    background-color: #f0f8ff;
    height: 100vh;
}
#gameCanvas {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    width: 100%;
    height: 80%;
    position: relative;
}
#emojiContainer {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin: 20px;
    font-size: 10vw;;
}
#progressBarContainer {
    width: 100%;
    height: 20px;
    background-color: #e0e0e0;
    border-radius: 10px;
    overflow: hidden;
    margin-bottom: 10px;
}
#progressBar {
    height: 100%;
    width: 100%;
    background-color: #76c7c0;
    transition: width 0.1s linear;
}
.emoji {
    font-size: 20vw;
}
#buttons {
    display: flex;
    justify-content: space-around;
    width: 100%;
}
button {
    width: 150px;
    height: 60px;
    font-size: 20px;
    cursor: pointer;
    border-radius: 10px;
    border: none;
}
#score, #time, #difficulty {
    font-size: 20px;
    margin: 10px;
}
#score { position: absolute; top: 10px; left: 10px; }
#difficulty { position: absolute; top: 10px; right: 10px; }
#time { position: absolute; top: 10px; left: 50%; transform: translateX(-50%); }
button:active {
    transform: scale(0.95);
}
@media (max-width: 768px) {
    .emoji {
        font-size: 140px;
    }
    button {
        width: 120px;
        height: 50px;
        font-size: 18px;
    }
}
@media (max-width: 480px) {
    .emoji {
        font-size: 100px;
    }
    button {
        width: 100px;
        height: 40px;
        font-size: 16px;
    }
}
    </style>
</head>
<body>

<div id="gameCanvas">
    <div id="progressBarContainer">
        <div id="progressBar"></div>
    </div>
    <div id="emojiContainer"></div>
    <div id="bigEmoji" class="emoji"></div>
    <div id="buttons">
        <button id="appearedButton">å‡ºç°è¿‡</button>
        <button id="notAppearedButton">æ²¡å‡ºç°</button>
    </div>
    <div id="score">å¾—åˆ†: 0</div>
    <div id="time">å‰©ä½™æ—¶é—´: 120ç§’</div>
    <div id="difficulty">éš¾åº¦: 0</div>
</div>

<script>
    const emojiList = ['ğŸ', 'ğŸ', 'ğŸ', 'ğŸŠ', 'ğŸ‹', 'ğŸŒ', 'ğŸ‰', 'ğŸ‡', 'ğŸ“', 'ğŸˆ', 'ğŸ’', 'ğŸ‘', 'ğŸ', 'ğŸ¥­', 'ğŸ¥¥', 'ğŸ¥', 'ğŸ…', 'ğŸ†', 'ğŸ¥‘', 'ğŸ¥¦', 'ğŸ¥’', 'ğŸ¥¬', 'ğŸ¥•', 'ğŸŒ½', 'ğŸŒ¶ï¸', 'ğŸ¥”', 'ğŸ ', 'ğŸŒ°', 'ğŸ¥œ'];
    const gameCanvas = document.getElementById('gameCanvas');
    const emojiContainer = document.getElementById('emojiContainer');
    const bigEmoji = document.getElementById('bigEmoji');
    const appearedButton = document.getElementById('appearedButton');
    const notAppearedButton = document.getElementById('notAppearedButton');
    const scoreElement = document.getElementById('score');
    const timeElement = document.getElementById('time');
    const difficultyElement = document.getElementById('difficulty');

    let score = 0;
    let timeLeft = 120;
    let difficulty = 0;
    let previousEmojis = [];
    let currentBigEmoji = '';
    let appearedBefore = false;
    let gameInterval;

    // åˆå§‹åŒ–æ¸¸æˆ
    function startGame() {
        score = 0;
        timeLeft = 120;
        difficulty = 0;
        updateUI();
        gameInterval = setInterval(gameLoop, 1000);
        startNewRound();
    }

    // æ›´æ–°ç•Œé¢æ˜¾ç¤º
    function updateUI() {
        scoreElement.textContent = `å¾—åˆ†: ${score}`;
        timeElement.textContent = `å‰©ä½™æ—¶é—´: ${timeLeft}ç§’`;
        difficultyElement.textContent = `éš¾åº¦: ${difficulty}`;
    }

    // æ¸¸æˆä¸»å¾ªç¯
    function gameLoop() {
        timeLeft--;
        if (timeLeft <= 0) {
            clearInterval(gameInterval);
            alert(`æ¸¸æˆç»“æŸï¼ä½ çš„æœ€ç»ˆå¾—åˆ†æ˜¯: ${score}`);
            return;
        }
        updateUI();
    }

    // å¼€å§‹æ–°çš„ä¸€è½®
    function startNewRound() {
        difficulty = Math.floor(score / 40);
        const numEmojis = 4 + difficulty; // éš¾åº¦å¢åŠ æ—¶ï¼Œé€‰é¡¹æ•°é‡å¢åŠ 

        // éšæœºé€‰å– numEmojis ä¸ªä¸åŒçš„ Emoji
        previousEmojis = [];
        while (previousEmojis.length < numEmojis) {
            const randomEmoji = emojiList[Math.floor(Math.random() * emojiList.length)];
            if (!previousEmojis.includes(randomEmoji)) {
                previousEmojis.push(randomEmoji);
            }
        }

        displayEmojis();
    }

    // æ˜¾ç¤º 4 ä¸ªéšæœº Emoji
    function displayEmojis() {
    emojiContainer.innerHTML = '';
    previousEmojis.forEach(emoji => {
        const emojiElement = document.createElement('div');
        emojiElement.textContent = emoji;
        emojiContainer.appendChild(emojiElement);
    });

    // åˆå§‹åŒ–è¿›åº¦æ¡
    const progressBar = document.getElementById('progressBar');
    let timeLeft = 5.0; // 5ç§’å€’è®¡æ—¶
    const interval = setInterval(() => {
        timeLeft -= 0.1;
        if (timeLeft <= 0) {
            clearInterval(interval);
            emojiContainer.innerHTML = ''; // æ¸…ç©º
            showBigEmoji();
        }
        progressBar.style.width = `${(timeLeft / 5.0) * 100}%`;
    }, 100);
}

    // æ˜¾ç¤ºå¤§Emojiå¹¶åˆ¤æ–­æ˜¯å¦å‡ºç°åœ¨ä¹‹å‰çš„å°Emojiä¸­
    function showBigEmoji() {
        appearedBefore = Math.random() < 0.5; // 50%çš„æ¦‚ç‡
        if (appearedBefore) {
            currentBigEmoji = previousEmojis[Math.floor(Math.random() * previousEmojis.length)];
        } else {
            let randomEmoji;
            do {
                randomEmoji = emojiList[Math.floor(Math.random() * emojiList.length)];
            } while (previousEmojis.includes(randomEmoji));
            currentBigEmoji = randomEmoji;
        }
        bigEmoji.textContent = currentBigEmoji; // æ˜¾ç¤ºå¤§Emoji
    }

    // å¤„ç†æŒ‰é’®ç‚¹å‡»
    function handleButtonClick(isAppeared) {
        if (isAppeared === appearedBefore) {
            score += 10;
        } else {
            score -= 10;
        }
        bigEmoji.textContent = ''; // æ¸…ç©ºå¤§Emoji
        updateUI();
        startNewRound(); // å¼€å¯æ–°ä¸€è½®
    }

    // æŒ‰é’®äº‹ä»¶ç»‘å®š
    appearedButton.addEventListener('click', () => handleButtonClick(true));
    notAppearedButton.addEventListener('click', () => handleButtonClick(false));

    // å¯åŠ¨æ¸¸æˆ
    startGame();
</script>

</body>
</html>
